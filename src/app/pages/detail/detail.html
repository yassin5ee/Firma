<app-header></app-header>

<nav class="top-nav">
    <a routerLink="/market" class="back-link"><i class="fas fa-arrow-left"></i> Retour au Marketplace</a>
</nav>

<div class="product-container" *ngIf="product; else loading">

    <div class="left-column">
        <div class="image-wrapper">
            <span class="category-badge" id="detail-category">{{ product.category }}</span>
            <img [src]="product.image || 'https://via.placeholder.com/400'" alt="Image produit" class="product-img"
                id="detail-image">
        </div>

        <div class="location-card">
            <h3><i class="fas fa-map-marker-alt"></i> Localisation</h3>
            <p id="detail-address">{{ product.address }}</p>
        </div>
    </div>

    <div class="right-column">
        <h1 class="product-title" id="detail-title">{{ product.title }}</h1>

        <div class="product-price">
            <span class="price-value" id="detail-price">{{ product.price }}</span>
            <span class="currency">TND</span>
            <span class="unit" id="detail-unit">/ {{ product.unit }}</span>
        </div>

        <div class="description-section">
            <h3>Description</h3>
            <p id="detail-description">{{ product.description }}</p>
        </div>

        <div class="purchase-box" id="purchaseBox">
            <h3>Configurer votre commande</h3>

            <div class="slider-container">
                <label>Quantit√© : <span id="selectedQty" style="color:#2ecc71; font-weight:bold;">{{ quantity
                        }}</span></label>
                <input type="range" min="1" max="50" [(ngModel)]="quantity" (input)="updatePrice()" class="slider"
                    id="qtySlider" style="width:100%;">
            </div>

            <div class="total-calculation" style="margin: 20px 0; font-size: 1.2rem;">
                <span>Total :</span>
                <span class="total-price" id="totalPrice" style="font-weight:bold;">{{ totalPrice | number:'1.2-2' }}
                    TND</span>
            </div>

            <button (click)="goToPayment()" class="btn-buy"
                style="background:#27ae60; color:white; padding:15px; width:100%; border:none; border-radius:8px; cursor:pointer;">
                Acheter maintenant <i class="fas fa-shopping-cart"></i>
            </button>
        </div>
    </div>
</div>

<ng-template #loading>
    <div class="loading-container">
        <h2 style='text-align:center; margin-top:50px;'>Chargement du produit...</h2>
    </div>
</ng-template>

<div *ngIf="error" class="error-container">
    <h2 style='text-align:center; margin-top:50px; color: red;'>{{ error }}</h2>
</div>